<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for src/graphManipulationFunctions.ts</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../prettify.css" />
    <link rel="stylesheet" href="../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../index.html">All files</a> / <a href="index.html">src</a> graphManipulationFunctions.ts
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">36.84% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>21/57</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">20% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>2/10</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">52.94% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>9/17</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">31.37% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>16/51</span>
      </div>
    </div>
  </div>
  <div class='status-line low'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126</td><td class="line-coverage quiet"><span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-yes">4x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-yes">4x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-yes">4x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span></td><td class="text"><pre class="prettyprint lang-js">import {ArrayToObject, ArrayById} from './utilities';
&nbsp;
&nbsp;
/* NODE */
&nbsp;
function deleteNode(g, nid) {
    let nodes = ArrayToObject(ArrayById(g.nodes)
    .filter(nd =&gt; nd.id !== nid.id));
    
    let nodesData = ArrayToObject(ArrayById(g.nodesData)
    .filter(nd =&gt; nd.id !== nid.id));
&nbsp;
    let edgesArray = ArrayById(g.edges)
    .filter(ed =&gt; (ed.source !== nid.id &amp;&amp; ed.target !== nid.id));
    
    let edgesData = ArrayToObject(ArrayById(g.edges)
    .filter(edata =&gt; edgesArray.some(ed =&gt; ed.id === edata.id)));
&nbsp;
    let edges = ArrayToObject(edgesArray);
&nbsp;
    return { ...g, 
            nodes: nodes, 
            nodesData: nodesData, 
            edges: edges, 
            edgesData: edgesData 
        };
}
&nbsp;
function addNewNode(g, nd) {
   
    let node: AppNode = { ...nd, 
                        ...{ id: getNewNodeId(g), outEdges: [], inEdges: [] } };
    
    let nodeData: NodeData = {...createBaseNodeData(), id: node.id};
    
    return {
        ...g,
        nodes: { ...g.nodes, [node.id]: node },
        nodesData: { ...g.nodesData, [node.id]: nodeData }
    }
}
&nbsp;
function createBaseNodeData() : NodeData {
    return {
        active: true,
        id: null,
        type: 'sink',
        displayFunctions: [],
        stepFunctions: [],
        displayData: {},
        value: 0
    }
}
&nbsp;
<span class="fstat-no" title="function not covered" >function nodePropertySet(</span>g, nodeData: NodeData): Graph {
    let <span class="cstat-no" title="statement not covered" >nd = </span>g.nodesData[nodeData.id];
<span class="cstat-no" title="statement not covered" >    nd = { ...nd, ...n</span>odeData };
    let <span class="cstat-no" title="statement not covered" >nodesData = { ...</span>g.nodesData, [nd.id]: nd };
<span class="cstat-no" title="statement not covered" >    console.log('new nodes data', n</span>odesData);
<span class="cstat-no" title="statement not covered" >    return { ...g, nodesData: n</span>odesData };
}
&nbsp;
/* EDGE */
&nbsp;
<span class="fstat-no" title="function not covered" >function shareEdge(</span>g, {<span class="cstat-no" title="statement not covered" >edge</span>, data}) {
<span class="cstat-no" title="statement not covered" >    return A</span>rrayById(g.edges).some(<span class="fstat-no" title="function not covered" >test =&gt; {</span>
        let <span class="cstat-no" title="statement not covered" >ts = </span>test.source;
        let <span class="cstat-no" title="statement not covered" >tt = </span>test.target;
<span class="cstat-no" title="statement not covered" >        if (tt === edge.source &amp;&amp; ts === edge.target || tt === edge.target &amp;&amp; ts === edge.source) {</span>
<span class="cstat-no" title="statement not covered" >            return t</span>rue;
        }
    });
}
&nbsp;
<span class="fstat-no" title="function not covered" >function addNewEdge(</span>g, o) {
<span class="cstat-no" title="statement not covered" >    if(shareEdge(g, o)) <span class="cstat-no" title="statement not covered" >r</span>eturn </span>g;
&nbsp;
    let <span class="cstat-no" title="statement not covered" >edge = { ...</span>o.edge, id: getNewEdgeId(g)};
    let <span class="cstat-no" title="statement not covered" >data: EdgeData = {...{ id: e</span>dge.id, active: true, linkFunctions: [] }, ...o.data};
&nbsp;
<span class="cstat-no" title="statement not covered" >    return {</span>
            ...g, 
            edges: { ...g.edges, [edge.id]: edge },
            edgesData: { ...g.edgesData, [edge.id]: data },
            nodes: {...g.nodes, ...updateOutNodes(g.nodes, edge)}
    };
}
&nbsp;
function getNewNodeId(g) {
    return 'n' + Object.keys(g.nodes).length;
}
&nbsp;
<span class="fstat-no" title="function not covered" >function getNewEdgeId(</span>g) {
<span class="cstat-no" title="statement not covered" >    return 'e' + Object.keys(g.edges).l</span>ength;
}
&nbsp;
<span class="fstat-no" title="function not covered" >function updateOutNodes(</span>nodes, e: Edge) {
    let <span class="cstat-no" title="statement not covered" >outEdges = </span>nodes[e.source].outEdges.concat([e.id])
    let <span class="cstat-no" title="statement not covered" >inEdges = </span>nodes[e.target].inEdges.concat([e.id])
    let <span class="cstat-no" title="statement not covered" >targetNode = { ...</span>nodes[e.target], inEdges: inEdges };
    let <span class="cstat-no" title="statement not covered" >sourceNode = { ...</span>nodes[e.source], outEdges: outEdges };
<span class="cstat-no" title="statement not covered" >    return { ...nodes, [e.target]: targetNode, [e.source]: sourceNode };</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function addLinkFunction(</span>g, edge: Edge, linkFunction: FunctionItem) : AppState {
    let <span class="cstat-no" title="statement not covered" >id = </span>edge.id;
    let <span class="cstat-no" title="statement not covered" >currentEdgeData = </span>g.edgesData[id];
    let <span class="cstat-no" title="statement not covered" >currentLinkFunctions = </span>currentEdgeData.linkFunctions;
    let <span class="cstat-no" title="statement not covered" >updatedEdgeData = {...currentEdgeData, l</span>inkFunctions: currentLinkFunctions.concat(linkFunction)}
<span class="cstat-no" title="statement not covered" >    return {...g, edgesData: {...g.edgesData, [id]: updatedEdgeData}};</span>
}
&nbsp;
/*untested*/
<span class="fstat-no" title="function not covered" >function updateEdge(</span>g, edge: Edge, edgeData: EdgeData) {
<span class="cstat-no" title="statement not covered" >    console.log('update data', edge, e</span>dgeData);
    let <span class="cstat-no" title="statement not covered" >id = </span>edge.id; 
    let <span class="cstat-no" title="statement not covered" >currentEdge = </span>g.edges[id];
    let <span class="cstat-no" title="statement not covered" >currentEdgeData = </span>g.edgesData[id];
    let <span class="cstat-no" title="statement not covered" >updatedEdge = {...</span>currentEdge, ...edge};
    let <span class="cstat-no" title="statement not covered" >updatedEdgeData = {...</span>currentEdgeData, ...edgeData};
    let <span class="cstat-no" title="statement not covered" >updatedEdges = {...</span>g.edges, id: updatedEdge};
    let <span class="cstat-no" title="statement not covered" >updatedEdgesData = {...</span>g.edgesData, id: updatedEdgeData};
<span class="cstat-no" title="statement not covered" >    return {...g, edges: updatedEdges, edgesData: u</span>pdatedEdgesData};
}
&nbsp;
export { addNewNode, addNewEdge, updateEdge, deleteNode, nodePropertySet, addLinkFunction }</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="https://istanbul.js.org/" target="_blank">istanbul</a> at Sun Nov 05 2017 16:16:53 GMT-0500 (EST)
</div>
</div>
<script src="../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../sorter.js"></script>
</body>
</html>
